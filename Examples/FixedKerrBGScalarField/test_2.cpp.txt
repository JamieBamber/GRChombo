#include <iostream>
#include <math.h>
#include "assoc_legendre.hpp"
#include <cstdio>

//using namespace std;

# define M_PI           3.14159265358979323846  /* pi */

int main() {
    std::cout << "Hello, world!\n";
    // make array to test on
    int N = 250;
    double c [N];
    double s [N];
    for (int i = -N; i < N; i++) {
	double x = (double)i/(N);
	c[i] = x;
	s[i] = sqrt(1 - x*x);
	std::cout << s[i] << std::endl;
    }
    FILE* outfile;
    outfile = fopen("/home/dc-bamb1/GRChombo/Analysis/data/test_assoc_legendre_data.dat", "w+"); 
    fprintf(outfile, "#l	m	data \n0	0	");
    for (int i = 0; i < 2*N; i++) {
	fprintf(outfile, "%.4f  ", (double)i/(N) - 1);
    };
    fprintf(outfile, "\n");
    for (int l = 1; l < 4; l++) {
	for (int m = 0;  m <= l; m++) {
		fprintf(outfile, "%d	%d	", l, m);
		for (int i = 0; i < 2*N-1; i++) {
			fprintf(outfile, "%.4f	", assoc_legendre_p(l, m, c[i], s[i]));
		}
		fprintf(outfile, "%.4f\n", assoc_legendre_p(l, m, c[2*N-1], s[2*N-1]));
	}
    }
   std::cout << "made data\n";
    return 0;
}
